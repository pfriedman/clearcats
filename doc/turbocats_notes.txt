CTSA Report is generated by a call to Rails.root/app/helpers/message_helpers.rb

send Investigators, Trainees, Publications, Participating Organizations, and Attachments to ReportMessageHelper

-----

def generate_report
  
 @investigators = Investigator.find(:all)
 @trainees = Trainee.find(:all)
 @publications = Publication.find(:all,:conditions=>{:reporting_year=>"2009"})
 @orgs = ParticipatingOrganization.find(:all)
 @attachments = Attachment.find(:all)
    
 doc = REXML::Document.new
 doc.add_element(ReportMessageHelper.new(@investigators,@trainees,@publications,@orgs,@attachments))
 doc.write( out_data = "",2 )

 #send_data( out_data, :type => "text/xml",:filename => "report.xml" )
 send_data( doc.to_s, :type => "text/xml",:filename => "report.xml" )
end

-----

Investigators and Trainees are both People
=============     ========

# Table name: people
#
#  id                       :integer         not null, primary key
#  type                     :string(255)
#  commons_username         :string(255)
#  last_name                :string(255)
#  first_name               :string(255)
#  middle_initial           :string(255)
#  area_of_expertise_code   :string(255)
#  training_type            :string(255)
#  appointed                :boolean
#  accepted                 :boolean
#  applied                  :boolean
#  interviewed              :boolean
#  degree_1                 :string(255)
#  degree_2                 :string(255)
#  end_date                 :date
#  date_of_appointment      :date
#  disadvantaged_background :boolean
#  has_disability           :boolean
#  ethnic_category          :string(255)
#  racial_category          :string(255)
#  gender                   :string(255)
#  mentor_commons_username  :string(255)
#  created_at               :datetime
#  updated_at               :datetime
#  invalid                  :boolean
#  validation_messages      :text
#  reporting_year           :string(255)
#  created_by               :integer
#  updated_by               :integer



Publications
============

# Table name: publications
#
#  id                   :integer         not null, primary key
#  person_id            :integer
#  cited                :boolean
#  pubmed_id            :integer
#  manuscript_id        :integer
#  missing_pmcid_reason :string(255)
#  created_at           :datetime
#  updated_at           :datetime
#  invalid              :boolean
#  validation_messages  :text
#  reporting_year       :string(255)
#  created_by           :integer
#  updated_by           :integer



Participating Organizations
===========================

# Table name: participating_organizations
#
#  id                  :integer         not null, primary key
#  name                :string(255)
#  city                :string(255)
#  country_name        :string(255)
#  us_state            :string(255)
#  created_at          :datetime
#  updated_at          :datetime
#  invalid             :boolean
#  validation_messages :text
#  reporting_year      :string(255)
#  created_by          :integer
#  updated_by          :integer



Attachments
===========

# Table name: attachments
#
#  id                  :integer         not null, primary key
#  title               :string(255)
#  type_code           :string(255)
#  filename            :string(255)
#  created_at          :datetime
#  updated_at          :datetime
#  doc_file_name       :string(255)
#  doc_content_type    :string(255)
#  doc_file_size       :integer
#  doc_updated_at      :datetime
#  invalid             :boolean
#  validation_messages :text
#  reporting_year      :string(255)
#  created_by          :integer
#  updated_by          :integer




