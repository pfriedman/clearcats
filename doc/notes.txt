ClearCATS
=========

Questions Regarding Intake Form
-------------------------------

- q. what is an "eRA Commons Username"?
  a. will be pulled from FSM Faculty Database (or reported/entered by person)

- q. are the entries associated with the user or the form/questionnaire/survey?
    (Publication PMCIDs - belongs to user or belongs to intake form which in turn belongs to user)
    - it appears that some data items should be associated with the form and others with the user
  a. 

-

General Questions
-----------------

- q. how are reports being generated with applications using surveyor?

- q. do we need to keep track of CTSA data for historical purposes? 
     (cf. turbo_ctsa constants in lib dir)
  a. yes

- q. who is the client? customer? in other words, who passes the user acceptance test?
  a. 

- q. what is a goal? activity? and what are the metrics used to determine if that goal, activity, etc. has been met? 
  a. 

- q. is there a difference between Center/Program/Department?
  a. Hierarchical Organizational Units

- 


Data Questions
--------------

  - User 
    - what is a department affiliation? school affiliation? 
      (are these enumerated values to be selected via ddl? or text entries?)
    q. Provided by FSM Faculty Database

  - Service Line
    - q. is a service line associated with CTSA data? (e.g. R01 Research Project)
      a. maybe but not always 


Reporting Questions
-------------------

 - CTSA - what is the difference between an Investigator and a Training Scholar ? (in data)
          - e.g. do only scholars have degree types? or only scholars have a mentor commons username ? 
          (training_type and trainee_status are currently being used - determine if this is sufficient)
 - CTSA - what is the participating organization? is it the top level organizational unit ?

Data Owners
-----------

CTSA

Organizational Unit

Application


Data Models
===========


Institution: (Application)
  name
  description
  
  (scope the application to an institution - the people who are using the application)


Centers: (Application)
  code/abbreviation
  name
  description

  belongs_to :institution

Roles: (App)
  
  name
  description
  
  has_and_belongs_to_many :users
  
  (Application Roles)
  - User 
    - someone who can make entries and view their own entries and aggregate views of their Program/Department
  - Unit Admin 
    - see detailed breakdowns for any personnel listed in their Program/Department
    - maintain Program/Department specific data (e.g. Intake Form data not CTSA defined)
  - NUCATS Admin
    - generate reports for all data in the application
    - maintain NUCATS/Application specific data (e.g. available Institutions, Organizational Units, Unit Admins)


Intake Form: (Organizational Unit)
  date
    
  belongs_to :user
  belongs_to :organizational_unit
  has_one: degree_type_one
  has_one: degree_type_two
  has_one: country
  has_one: specialty
  has_and_belongs_to_many: institution_positions
  has_and_belongs_to_many: organizations
  has_and_belongs_to_many: activity_codes
  
  has_and_belongs_to_many: awards

Person/User: (App)

  attributes:
  
  last_name
  first_name
  middle_name
  email
  
  department_affiliation
  school_affiliation
  era_commons_username
  last_4_digits_of_ssn
  
  =====
  BCSEC
  =====

  User:

  ATTRIBUTES = :username, :first_name, :middle_name, :last_name,
    :title, :business_phone, :fax, :email, :address, :city, :state, :country,
    :nu_employee_id, :personnel_id
  
  =====
  
  has_and_belongs_to_many :roles
  belongs_to :institution
  has_many :addresses
  has_many :positions
  
  has_one :specialty - ctsa (a.k.a. "Area of Expertise")
  has_many :degree_types (?) - ctsa
  belongs_to :ethnic_background - ctsa
  belongs_to :Racial_background - ctsa
  belongs_to :country - ctsa
  
  (ctsa phs_organizations & non_phs_organizations)
  has_many :user_awards
  has_many :awards, :through => :user_awards
  
  has_many :publications
  has_many :project_informations
  
  has_many :user_pending_approvals
  has_many :pending_approvals through :user_pending_approvals
  
  has_many :institute_organizational_units
  belongs_to :protections_training
  
  has_many :responses (from surveyor)
  has_many :attachments
  
  
Address: (App)

  line_one
  line_two
  city
  state/province
  postal_code
  
  belongs_to :country


Project: (App)
  name
  description
  
  
Milestone: (App)
  name
  description
  
  goal?
  position?
  expected_date?
  actual_date?
  
  has_many :activities
  
  
Activity: (App)
  name
  description
  
  belongs_to :project
  belongs_to :milestone
  has_many :identified_contacts
  has_many :unidentified_contacts
  has_many :attachments
  

TimeEntry: (App)
  comments
  spent_on
  hours
  tyear
  tmonth
  tweek
  
  belongs_to :activity
  belongs_to :user


Contact:
  type (Identified/Unidentified)
  description
  
  internal?
  first_name
  last_name
  title
  email
  
  has_many :addresses


UnidentifiedContact: (App)
  description
  
  belongs_to :activity

  
Position: (Organizational Unit)
  name
  
  belongs_to :institute_organizational_unit
  
  
EthnicBackground: (ctsa)
  description


RacialBackground: (ctsa)
  description


Award: (ctsa)
  organization (phs or non-phs) ?
  grant_number
  year_of_award
  grant_title
  grant_amount

  belongs_to :user
  has_and_belongs_to_many :intake_forms

  
Publication: (Organizational Unit)
  pmcid
  published_with_mentor
  year_published
  nihms_number
  
  
ProjectInformation: (Organizational Unit ?)
  type (IRB/IACUC)
  tracking_number
  approval_institution
  project_title
  approval_date
  principal_investigator
  
  
PendingApproval: (Organizational Unit)
  code
  name/description
  
  
UserPendingApproval: (Organizational Unit)
  approval_type
  approval_number
  approval_title
  approval_date
  nucats_contribution
  
  
ProtectionsTraining: (Organizational Unit)
  administering_institution
  date_completed
  not_applicable

  
Document: (App)
  original_filename
  unique_filename
  content_type
  file_size
  
  belongs_to :owner, :polymorphic => true
  
  
CTSA Data
---------

Country:
  name
  
Activity Code:
  code
  name
  
DegreeType:
  type (1 or 2)
  code
  name
  
Organization:
  type (PHS or NonPHS)
  code
  name

Specialty:
  code
  name
  
UsState:
  abbreviation
  name